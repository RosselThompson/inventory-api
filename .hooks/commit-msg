#!/bin/bash

# Fetch the commit message
commit_msg_file=$1
commit_msg=$(cat "$commit_msg_file")

# Regular expression for Conventional Commits format
conventional_commit_regex="^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\([a-z]+\))?: .{1,50}$"

# Check if the commit message matches the Conventional Commits format
if [[ "$commit_msg" =~ $conventional_commit_regex ]]; then
  echo "Commit message is valid."
  exit 0
else
  echo "Commit message is invalid."
  echo "Please use the Conventional Commits format:"
  echo ""
  echo "<type>(<scope>): <description>"
  echo ""
  echo "Valid types: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert"
  echo "scope is optional"
  echo ""
  echo "feat(login): add login feature"
  echo "feat: add login feature"
  echo ""
  exit 1
fi
